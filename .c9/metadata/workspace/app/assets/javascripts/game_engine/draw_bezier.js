{"filter":false,"title":"draw_bezier.js","tooltip":"/app/assets/javascripts/game_engine/draw_bezier.js","undoManager":{"mark":30,"position":30,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":61,"column":1},"action":"insert","lines":["function drawBezier(context, points, max_t) {","\t","\t// Draw guides","\tcontext.lineWidth = 0.5;","\tcontext.strokeStyle = \"rgb(213, 213, 213)\";","\tcontext.beginPath();","\tcontext.moveTo(points[0].x, points[0].y);","\tcontext.lineTo(points[1].x, points[1].y);","\tcontext.stroke();","\tcontext.beginPath();","\tcontext.moveTo(points[2].x, points[2].y);","\tcontext.lineTo(points[3].x, points[3].y);","\tcontext.stroke();","\t","\t// Label end points","\tcontext.fillStyle = \"rgb(0, 0, 0)\";\t","\tcontext.fillRect(points[0].x-4, points[0].y-4, 8, 8);","\tcontext.fillRect(points[3].x-4, points[3].y-4, 8, 8);","\t","\t// Label control points","\tcontext.strokeStyle = \"rgb(0, 0, 0)\";","\tcontext.fillStyle = \"rgb(255, 255, 255)\";","\tcontext.beginPath();","\tcontext.moveTo(points[1].x, points[1].y-5);","\tcontext.lineTo(points[1].x+5, points[1].y);","\tcontext.lineTo(points[1].x, points[1].y+5);","\tcontext.lineTo(points[1].x-5, points[1].y);","\tcontext.lineTo(points[1].x, points[1].y-5);","\tcontext.fill();","\tcontext.stroke();","\tcontext.beginPath();","\tcontext.moveTo(points[2].x, points[2].y-5);","\tcontext.lineTo(points[2].x+5, points[2].y);","\tcontext.lineTo(points[2].x, points[2].y+5);","\tcontext.lineTo(points[2].x-5, points[2].y);","\tcontext.lineTo(points[2].x, points[2].y-5);","\tcontext.fill();","\tcontext.stroke();\t","\t","\t// Begin new path","\tcontext.beginPath();","\tcontext.moveTo(points[0].x, points[0].y);","\t","\t// Draw spline segemnts\t","\tfor (var t = 0.01; t <= max_t; t += 0.01) {","\t\tcontext.lineTo(","\t\t\t","\t\t\tMath.pow(1 - t, 3) * points[0].x + ","\t\t\t3 * t * Math.pow(1 - t, 2) * points[1].x +","\t\t\t3 * Math.pow(t, 2) * (1 - t) * points[2].x +","\t\t\tMath.pow(t, 3) * points[3].x,","\t\t\t","\t\t\tMath.pow(1 - t, 3) * points[0].y + ","\t\t\t3 * t * Math.pow(1 - t, 2) * points[1].y +","\t\t\t3 * Math.pow(t, 2) * (1 - t) * points[2].y +","\t\t\tMath.pow(t, 3) * points[3].y","\t\t);\t\t\t","\t}","\t","\t// Stroke path","\tcontext.stroke();","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":37,"column":0},"end":{"row":37,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":37,"column":0},"end":{"row":37,"column":1},"action":"insert","lines":["/"]},{"start":{"row":36,"column":0},"end":{"row":36,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":36,"column":0},"end":{"row":36,"column":1},"action":"insert","lines":["/"]},{"start":{"row":35,"column":0},"end":{"row":35,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":35,"column":0},"end":{"row":35,"column":1},"action":"insert","lines":["/"]},{"start":{"row":34,"column":0},"end":{"row":34,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":34,"column":0},"end":{"row":34,"column":1},"action":"insert","lines":["/"]},{"start":{"row":33,"column":0},"end":{"row":33,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":33,"column":0},"end":{"row":33,"column":1},"action":"insert","lines":["/"]},{"start":{"row":32,"column":0},"end":{"row":32,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":32,"column":0},"end":{"row":32,"column":1},"action":"insert","lines":["/"]},{"start":{"row":31,"column":0},"end":{"row":31,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":31,"column":0},"end":{"row":31,"column":1},"action":"insert","lines":["/"]},{"start":{"row":30,"column":0},"end":{"row":30,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":30,"column":0},"end":{"row":30,"column":1},"action":"insert","lines":["/"]},{"start":{"row":29,"column":0},"end":{"row":29,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":29,"column":0},"end":{"row":29,"column":1},"action":"insert","lines":["/"]},{"start":{"row":28,"column":0},"end":{"row":28,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":28,"column":0},"end":{"row":28,"column":1},"action":"insert","lines":["/"]},{"start":{"row":27,"column":0},"end":{"row":27,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":27,"column":0},"end":{"row":27,"column":1},"action":"insert","lines":["/"]},{"start":{"row":26,"column":0},"end":{"row":26,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":26,"column":0},"end":{"row":26,"column":1},"action":"insert","lines":["/"]},{"start":{"row":25,"column":0},"end":{"row":25,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":25,"column":0},"end":{"row":25,"column":1},"action":"insert","lines":["/"]},{"start":{"row":24,"column":0},"end":{"row":24,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":24,"column":0},"end":{"row":24,"column":1},"action":"insert","lines":["/"]},{"start":{"row":23,"column":0},"end":{"row":23,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":23,"column":0},"end":{"row":23,"column":1},"action":"insert","lines":["/"]},{"start":{"row":22,"column":0},"end":{"row":22,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":22,"column":0},"end":{"row":22,"column":1},"action":"insert","lines":["/"]},{"start":{"row":21,"column":0},"end":{"row":21,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":21,"column":0},"end":{"row":21,"column":1},"action":"insert","lines":["/"]},{"start":{"row":20,"column":0},"end":{"row":20,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":20,"column":0},"end":{"row":20,"column":1},"action":"insert","lines":["/"]},{"start":{"row":19,"column":0},"end":{"row":19,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":19,"column":0},"end":{"row":19,"column":1},"action":"insert","lines":["/"]},{"start":{"row":18,"column":0},"end":{"row":18,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":18,"column":0},"end":{"row":18,"column":1},"action":"insert","lines":["/"]},{"start":{"row":17,"column":0},"end":{"row":17,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":17,"column":0},"end":{"row":17,"column":1},"action":"insert","lines":["/"]},{"start":{"row":16,"column":0},"end":{"row":16,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":16,"column":0},"end":{"row":16,"column":1},"action":"insert","lines":["/"]},{"start":{"row":15,"column":0},"end":{"row":15,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":15,"column":0},"end":{"row":15,"column":1},"action":"insert","lines":["/"]},{"start":{"row":14,"column":0},"end":{"row":14,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":14,"column":0},"end":{"row":14,"column":1},"action":"insert","lines":["/"]},{"start":{"row":13,"column":0},"end":{"row":13,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":13,"column":0},"end":{"row":13,"column":1},"action":"insert","lines":["/"]},{"start":{"row":12,"column":0},"end":{"row":12,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":12,"column":0},"end":{"row":12,"column":1},"action":"insert","lines":["/"]},{"start":{"row":11,"column":0},"end":{"row":11,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":11,"column":0},"end":{"row":11,"column":1},"action":"insert","lines":["/"]},{"start":{"row":10,"column":0},"end":{"row":10,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":10,"column":0},"end":{"row":10,"column":1},"action":"insert","lines":["/"]},{"start":{"row":9,"column":0},"end":{"row":9,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":9,"column":0},"end":{"row":9,"column":1},"action":"insert","lines":["/"]},{"start":{"row":8,"column":0},"end":{"row":8,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":8,"column":0},"end":{"row":8,"column":1},"action":"insert","lines":["/"]},{"start":{"row":7,"column":0},"end":{"row":7,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":7,"column":0},"end":{"row":7,"column":1},"action":"insert","lines":["/"]},{"start":{"row":6,"column":0},"end":{"row":6,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":6,"column":0},"end":{"row":6,"column":1},"action":"insert","lines":["/"]},{"start":{"row":5,"column":0},"end":{"row":5,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":5,"column":0},"end":{"row":5,"column":1},"action":"insert","lines":["/"]},{"start":{"row":4,"column":0},"end":{"row":4,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":4,"column":0},"end":{"row":4,"column":1},"action":"insert","lines":["/"]},{"start":{"row":3,"column":0},"end":{"row":3,"column":1},"action":"remove","lines":["\t"]},{"start":{"row":3,"column":0},"end":{"row":3,"column":1},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":37,"column":1},"end":{"row":37,"column":2},"action":"insert","lines":["/"]},{"start":{"row":36,"column":1},"end":{"row":36,"column":2},"action":"insert","lines":["/"]},{"start":{"row":35,"column":1},"end":{"row":35,"column":2},"action":"insert","lines":["/"]},{"start":{"row":34,"column":1},"end":{"row":34,"column":2},"action":"insert","lines":["/"]},{"start":{"row":33,"column":1},"end":{"row":33,"column":2},"action":"insert","lines":["/"]},{"start":{"row":32,"column":1},"end":{"row":32,"column":2},"action":"insert","lines":["/"]},{"start":{"row":31,"column":1},"end":{"row":31,"column":2},"action":"insert","lines":["/"]},{"start":{"row":30,"column":1},"end":{"row":30,"column":2},"action":"insert","lines":["/"]},{"start":{"row":29,"column":1},"end":{"row":29,"column":2},"action":"insert","lines":["/"]},{"start":{"row":28,"column":1},"end":{"row":28,"column":2},"action":"insert","lines":["/"]},{"start":{"row":27,"column":1},"end":{"row":27,"column":2},"action":"insert","lines":["/"]},{"start":{"row":26,"column":1},"end":{"row":26,"column":2},"action":"insert","lines":["/"]},{"start":{"row":25,"column":1},"end":{"row":25,"column":2},"action":"insert","lines":["/"]},{"start":{"row":24,"column":1},"end":{"row":24,"column":2},"action":"insert","lines":["/"]},{"start":{"row":23,"column":1},"end":{"row":23,"column":2},"action":"insert","lines":["/"]},{"start":{"row":22,"column":1},"end":{"row":22,"column":2},"action":"insert","lines":["/"]},{"start":{"row":21,"column":1},"end":{"row":21,"column":2},"action":"insert","lines":["/"]},{"start":{"row":20,"column":1},"end":{"row":20,"column":2},"action":"insert","lines":["/"]},{"start":{"row":19,"column":1},"end":{"row":19,"column":2},"action":"insert","lines":["/"]},{"start":{"row":18,"column":1},"end":{"row":18,"column":2},"action":"insert","lines":["/"]},{"start":{"row":17,"column":1},"end":{"row":17,"column":2},"action":"insert","lines":["/"]},{"start":{"row":16,"column":1},"end":{"row":16,"column":2},"action":"insert","lines":["/"]},{"start":{"row":15,"column":1},"end":{"row":15,"column":2},"action":"insert","lines":["/"]},{"start":{"row":14,"column":1},"end":{"row":14,"column":2},"action":"insert","lines":["/"]},{"start":{"row":13,"column":1},"end":{"row":13,"column":2},"action":"insert","lines":["/"]},{"start":{"row":12,"column":1},"end":{"row":12,"column":2},"action":"insert","lines":["/"]},{"start":{"row":11,"column":1},"end":{"row":11,"column":2},"action":"insert","lines":["/"]},{"start":{"row":10,"column":1},"end":{"row":10,"column":2},"action":"insert","lines":["/"]},{"start":{"row":9,"column":1},"end":{"row":9,"column":2},"action":"insert","lines":["/"]},{"start":{"row":8,"column":1},"end":{"row":8,"column":2},"action":"insert","lines":["/"]},{"start":{"row":7,"column":1},"end":{"row":7,"column":2},"action":"insert","lines":["/"]},{"start":{"row":6,"column":1},"end":{"row":6,"column":2},"action":"insert","lines":["/"]},{"start":{"row":5,"column":1},"end":{"row":5,"column":2},"action":"insert","lines":["/"]},{"start":{"row":4,"column":1},"end":{"row":4,"column":2},"action":"insert","lines":["/"]},{"start":{"row":3,"column":1},"end":{"row":3,"column":2},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":61,"column":1},"end":{"row":62,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":62,"column":0},"end":{"row":63,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":0},"end":{"row":85,"column":1},"action":"insert","lines":["var CP = window.CanvasRenderingContext2D && CanvasRenderingContext2D.prototype;","if (CP.lineTo) {","    CP.dashedLine = function(x, y, x2, y2, da) {","        if (!da) da = [10,5];","        this.save();","        var dx = (x2-x), dy = (y2-y);","        var len = Math.sqrt(dx*dx + dy*dy);","        var rot = Math.atan2(dy, dx);","        this.translate(x, y);","        this.moveTo(0, 0);","        this.rotate(rot);       ","        var dc = da.length;","        var di = 0, draw = true;","        x = 0;","        while (len > x) {","            x += da[di++ % dc];","            if (x > len) x = len;","            draw ? this.lineTo(x, 0): this.moveTo(x, 0);","            draw = !draw;","        }       ","        this.restore();","    }","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":45,"column":10},"end":{"row":45,"column":16},"action":"remove","lines":["lineTo"]},{"start":{"row":45,"column":10},"end":{"row":45,"column":20},"action":"insert","lines":["dashedLine"]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":31},"end":{"row":55,"column":32},"action":"insert","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":55,"column":32},"end":{"row":56,"column":0},"action":"insert","lines":["",""]},{"start":{"row":56,"column":0},"end":{"row":56,"column":3},"action":"insert","lines":["\t\t\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":56,"column":3},"end":{"row":56,"column":9},"action":"insert","lines":["[10,5]"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":45},"end":{"row":37,"column":20},"action":"remove","lines":["","//context.beginPath();","//context.moveTo(points[0].x, points[0].y);","//context.lineTo(points[1].x, points[1].y);","//context.stroke();","//context.beginPath();","//context.moveTo(points[2].x, points[2].y);","//context.lineTo(points[3].x, points[3].y);","//context.stroke();","//","//// Label end points","//context.fillStyle = \"rgb(0, 0, 0)\";\t","//context.fillRect(points[0].x-4, points[0].y-4, 8, 8);","//context.fillRect(points[3].x-4, points[3].y-4, 8, 8);","//","//// Label control points","//context.strokeStyle = \"rgb(0, 0, 0)\";","//context.fillStyle = \"rgb(255, 255, 255)\";","//context.beginPath();","//context.moveTo(points[1].x, points[1].y-5);","//context.lineTo(points[1].x+5, points[1].y);","//context.lineTo(points[1].x, points[1].y+5);","//context.lineTo(points[1].x-5, points[1].y);","//context.lineTo(points[1].x, points[1].y-5);","//context.fill();","//context.stroke();","//context.beginPath();","//context.moveTo(points[2].x, points[2].y-5);","//context.lineTo(points[2].x+5, points[2].y);","//context.lineTo(points[2].x, points[2].y+5);","//context.lineTo(points[2].x-5, points[2].y);","//context.lineTo(points[2].x, points[2].y-5);","//context.fill();","//context.stroke();\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":0},"end":{"row":4,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":1},"end":{"row":4,"column":3},"action":"remove","lines":["//"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":0},"end":{"row":3,"column":1},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":0},"end":{"row":3,"column":1},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":0},"end":{"row":3,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":1},"end":{"row":3,"column":2},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":1},"end":{"row":3,"column":2},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":1},"end":{"row":2,"column":15},"action":"remove","lines":["// Draw guides"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":0},"end":{"row":2,"column":1},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":1},"end":{"row":2,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":11,"column":10},"end":{"row":11,"column":20},"action":"remove","lines":["dashedLine"]},{"start":{"row":11,"column":10},"end":{"row":11,"column":16},"action":"insert","lines":["lineTo"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":3},"end":{"row":22,"column":9},"action":"remove","lines":["[10,5]"]}]}],[{"group":"doc","deltas":[{"start":{"row":22,"column":0},"end":{"row":22,"column":3},"action":"remove","lines":["\t\t\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":32},"end":{"row":22,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":21,"column":31},"end":{"row":21,"column":32},"action":"remove","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":28,"column":0},"end":{"row":51,"column":1},"action":"remove","lines":["","var CP = window.CanvasRenderingContext2D && CanvasRenderingContext2D.prototype;","if (CP.lineTo) {","    CP.dashedLine = function(x, y, x2, y2, da) {","        if (!da) da = [10,5];","        this.save();","        var dx = (x2-x), dy = (y2-y);","        var len = Math.sqrt(dx*dx + dy*dy);","        var rot = Math.atan2(dy, dx);","        this.translate(x, y);","        this.moveTo(0, 0);","        this.rotate(rot);       ","        var dc = da.length;","        var di = 0, draw = true;","        x = 0;","        while (len > x) {","            x += da[di++ % dc];","            if (x > len) x = len;","            draw ? this.lineTo(x, 0): this.moveTo(x, 0);","            draw = !draw;","        }       ","        this.restore();","    }","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":27,"column":1},"end":{"row":28,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":24},"end":{"row":3,"column":42},"action":"remove","lines":["rgb(213, 213, 213)"]},{"start":{"row":3,"column":24},"end":{"row":3,"column":25},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":25},"end":{"row":3,"column":26},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":26},"end":{"row":3,"column":27},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":21},"end":{"row":6,"column":22},"action":"insert","lines":[" "]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":16,"column":32},"end":{"row":16,"column":32},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1421253578969,"hash":"d9b105c47b4ec6357e4bb3e0f6c23dda3fdc5fb1"}